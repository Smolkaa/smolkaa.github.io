---
title: "Orbital Mechanics Functions"
format:
  html: default
---

{{< include /resources/latex/_defs.qmd >}}
{{< include /resources/latex/_symbols.qmd >}}

::: {.hidden }
# {{< meta title >}}
:::

---

For additional background information and the theory behind gravitational potential fields, as well as gravitational forces, see the [Gravitational Potential](/documentation/fundamentals/gravitational_potential.qmd) section.


## Orbital Parameters

The functions below derive various orbital parameters, such as the eccentricity, the semi-major axis, or the true anomaly, from the given input parameters, used for the spherical, two-dimensional trajectory calculation [@Walter2018; @Schoerghofer2022a]. While there are multiple ways of rewriting these equations, for example, by simply inserting the definition of one of the input parameters into the equation, the primary inputs necessary to solve these functions are the current velocity vector $\vec\velocity\in\Set{R}^3$, the mass of the planetary object $\mass\in\Set{R}^+$, and the current radial position $\radius\in\Set{R}^+$. Note that the velocity vector has to be provided in a [local cartesian coordinate system](/documentation/math_num_comp/coordinate_systems.qmd) with $\velocity_1$ and $\velocity_2$ being the components in the horizontal plane and $\velocity_3$ being the vertical component. The physical parameters are usually defined for all or all positive real numbers, $\Set{R}$ or $\Set{R}^+$, with the exception of the azimuth and zenith angle, $\azimuthAngle, \zenithAngle\in\left[-\pi, \pi\right)$, and the true anomaly, eccentric anomaly, and mean anomaly, $\trueAnomaly, \eccentricAnomaly, \meanAnomaly\in\left[0, 2\pi\right)$, respectively.




Every function below can be solved analytically, except for Eq. \eqref{eq:eccentric_anomaly_e_M}. This equation is the iterative solution of Kepler's equation, based on the definition of the mean anomaly, see Eq. \eqref{eq:mean_anomaly_e_E}. Nonetheless, one can solve for the eccentric anomaly numerically using stationary iterative methods. The starting point $\eccentricAnomaly_0=\meanAnomaly$ given in the Table could also be substituted with $\eccentricAnomaly_0=0$, where $\eccentricAnomaly_1=\meanAnomaly$ leads to the same numerical solution after just one more iteration step.



### Azimuth Angle -- $\azimuthAngle$ {#sec-azimuth-angle}
The azimuth angle $\azimuthAngle$ can be calculated using the following multi-case definition:
\begin{equation}
    \azimuthAngle\left(\vec\velocity \right) = \begin{cases}
        \cos^{-1}\left(\velocity_2/\sqrt{\velocity_1^2 + \velocity_2^2}\right) & \text{for } \velocity_2\geq0\\
        -\cos^{-1}\left(\velocity_2/\sqrt{\velocity_1^2 + \velocity_2^2}\right) & \text{for } \velocity_2<0
    \end{cases} \label{eq:azimuth_angle_v}
\end{equation}
with a [local cartesian](/documentation/math_num_comp/coordinate_systems.qmd) velocity vector $\vec\velocity = \left[\velocity_1, \velocity_2, \velocity_3\right]^T$. The equation can be rewritten as a single-case equation, avoiding the inverse cosine expression:
\begin{equation}
    \cos\azimuthAngle = \frac{\velocity_2}{\sqrt{\velocity_1^2+\velocity_2^2}}.
\end{equation} 

{{< include orbital_mechanics_functions/apirefs/_azimuth_angle.qmd >}}


### Ecccentric Anomaly -- $\eccentricAnomaly$ {#sec-eccentric-anomaly}
\begin{align}
    \eccentricAnomaly\left(\eccentricity, \trueAnomaly\right) &= \begin{cases}
        2 \tan^{-1}\left( \sqrt{\frac{1-\eccentricity}{1+\eccentricity}} \cdot \tan\left(\frac{\trueAnomaly}{2}\right) \right) & \text{for } 0\leq\trueAnomaly<\pi\\
        2 \tan^{-1}\left( \sqrt{\frac{1-\eccentricity}{1+\eccentricity}} \cdot \tan\left(\frac{\trueAnomaly}{2}\right) \right) + 2\pi & \text{for } \pi\leq\trueAnomaly<2\pi
    \end{cases}  \label{eq:eccentric_anomaly_e_theta} \\[3mm]
     \eccentricAnomaly_{i+1}\left(\eccentricity, \meanAnomaly, \eccentricAnomaly_i\right) &= \meanAnomaly + \eccentricity\sin \eccentricAnomaly_i \quad\text{ with }\quad \eccentricAnomaly_0 = \meanAnomaly  \label{eq:eccentric_anomaly_e_M}
\end{align}
Similar to the azimuth angle before, Eq. \eqref{eq:eccentric_anomaly_e_theta} can be rewritten as a single-case equation, avoiding the inverse tangent expression:
\begin{equation}
    \tan\left(\eccentricAnomaly/2\right) = \sqrt{\frac{1-\eccentricity}{1+\eccentricity}} \cdot \tan\left(\trueAnomaly/2\right).
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_eccentric_anomaly.qmd >}}


### Eccentricity -- $\eccentricity$ {#sec-eccentricity}
\begin{align}
    \eccentricity\left(\relativeKineticEnergy, \zenithAngle\right) &= \sqrt{1 - 4 \relativeKineticEnergy \cdot (1 - \relativeKineticEnergy) \cdot \sin^2 \zenithAngle}  \label{eq:eccentricity_epskin_psi} \\
    \eccentricity\left(\semiMajorAxis, \semiLatusRectum\right) &= \sqrt{1 - \frac{\semiLatusRectum}{\semiMajorAxis}}  \label{eq:eccentricity_a_p} \\
    \eccentricity\left(\radius, \semiLatusRectum, \trueAnomaly\right) &= \frac{1}{\cos\trueAnomaly}\cdot\left(\frac{\semiLatusRectum}{\radius} - 1\right)  \label{eq:eccentricity_r_p_theta} \\
    \eccentricity\left(\eccentricAnomaly, \meanAnomaly\right) &= \frac{\eccentricAnomaly - \meanAnomaly}{\sin \eccentricAnomaly}  \label{eq:eccentricity_E_M}
\end{align}

{{< include orbital_mechanics_functions/apirefs/_eccentricity.qmd >}}


### Escape Velocity -- $\velocity_{esc}$ {#sec-escape-velocity}
\begin{equation}
    \velocity_{esc}\left(\radius, \mass\right) = \sqrt{\frac{2 \GravitationalConstant \mass}{\radius}} \label{eq:escape_velocity_r_m}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_escape_velocity.qmd >}}


### Ground Track Distance -- $\distance$ {#sec-ground-track-distance}
\begin{equation}
    \distance\left(\radius, \Delta\trueAnomaly\right) = \radius \cdot \Delta\trueAnomaly  \label{eq:ground_track_distance_r_dtheta}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_ground_track_distance.qmd >}}


### Mean Anomaly  -- $\meanAnomaly$ {#sec-mean-anomaly}
\begin{equation}
    \meanAnomaly\left(\eccentricity, \eccentricAnomaly\right) = \eccentricAnomaly - \eccentricity\sin \eccentricAnomaly  \label{eq:mean_anomaly_e_E}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_mean_anomaly.qmd >}}


### Orbit Period -- $\period$ {#sec-orbit-period}
\begin{equation}
    \period\left(\semiMajorAxis, \mass\right) = 2\pi\sqrt{\frac{\semiMajorAxis^3}{\GravitationalConstant \mass}}  \label{eq:orbit_period_a_m}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_orbit_period.qmd >}}


### Orbit Time -- $\Time$ {sec-orbit-time}
\begin{equation}
    \Time\left(\meanAnomaly, \period\right) = \frac{\meanAnomaly}{2\pi} \cdot \period  \label{eq:orbit_time_M_P}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_orbit_time.qmd >}}


### Relative Kinetic Energy -- $\relativeKineticEnergy$ {#sec-relative-kinetic-energy}
\begin{align}
    \relativeKineticEnergy\left(\vec\velocity, \velocity_{esc}\right) &= \left(\frac{|\vec\velocity|}{\velocity_{esc}}\right)^2  \label{eq:relative_Ekin_v_vesc} \\
    \relativeKineticEnergy\left(\radius, \semiMajorAxis\right) &= 1 - \frac{\radius}{2\semiMajorAxis}  \label{eq:relative_Ekin_r_a} \\
    \relativeKineticEnergy\left(\eccentricity, \trueAnomaly\right) &= 1 - \frac{1 - \eccentricity^2}{2 + 2\eccentricity\cos\left(\trueAnomaly\right)}  \label{eq:relative_Ekin_e_theta}
\end{align}

{{< include orbital_mechanics_functions/apirefs/_relative_kinetic_energy.qmd >}}

### Semi-Latus Rectum -- $\semiLatusRectum$ {#sec-semi-latus-rectum}
\begin{align}
    \semiLatusRectum\left(\semiMajorAxis, \eccentricity\right) &= \semiMajorAxis \cdot (1 - \eccentricity^2)  \label{eq:semi_latus_rectum_a_e} \\
    \semiLatusRectum\left(\radius, \eccentricity, \trueAnomaly\right) &= \radius \cdot \left(1 + \eccentricity \cdot \cos \trueAnomaly\right)  \label{eq:semi_latus_rectum_r_e_theta}
\end{align}

{{< include orbital_mechanics_functions/apirefs/_semi_latus_rectum.qmd >}}

### Semi-Major Axis -- $\semiMajorAxis$ {#sec-semi-major-axis}
\begin{align}
    \semiMajorAxis\left(\radius, \relativeKineticEnergy\right) &= \frac{\radius}{2 \cdot \left(1 - \relativeKineticEnergy \right)}  \label{eq:semi_major_axis_r_epskin} \\
    \semiMajorAxis\left(\semiLatusRectum, \eccentricity\right) &= \frac{\semiLatusRectum}{1 - \eccentricity^2}  \label{eq:semi_major_axis_p_e}
\end{align}

{{< include orbital_mechanics_functions/apirefs/_semi_major_axis.qmd >}}

### True Anomaly -- $\trueAnomaly$ {#sec-true-anomaly}
\begin{align}
    \trueAnomaly\left(\radius, \semiMajorAxis, \eccentricity\right) &= \cos^{-1}\left(\frac{1}{\eccentricity} \cdot \left(\frac{\semiMajorAxis}{\radius} \left( 1 - \eccentricity^2 \right) -1 \right)\right)  \label{eq:true_anomaly_r_a_e} \\
    \trueAnomaly\left(\eccentricity, \relativeKineticEnergy\right) &= \cos^{-1}\left(\frac{1}{\eccentricity} \cdot \left(\frac{1 - \eccentricity^2}{2-2 \relativeKineticEnergy} -1 \right)\right)  \label{eq:true_anomaly_e_epskin}
\end{align}

{{< include orbital_mechanics_functions/apirefs/_true_anomaly.qmd >}}

### Zenith Angle -- $\zenithAngle$ {#sec-zenith-angle}
\begin{equation}
    \zenithAngle\left(\vec\velocity\right) = \tan^{-1}\left(\frac{\sqrt{\velocity_1^2 + \velocity_2^2}}{\velocity_3}\right)  \label{eq:zenith_angle_v}
\end{equation}

{{< include orbital_mechanics_functions/apirefs/_zenith_angle.qmd >}}