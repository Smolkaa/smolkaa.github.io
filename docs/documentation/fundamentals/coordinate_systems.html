<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alexander Smolka, a.smolka@tum.de  Technical University of Munich">
<meta name="dcterms.date" content="2023-08-02">

<title>ExESS - 2.1 Coordinate Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../documentation/fundamentals/numerical_grids.html" rel="next">
<link href="../../documentation/introduction/introduction.html" rel="prev">
<link href="../..//resources/logo/exess_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
    MathJax = { 
        tex: { 
            tags: 'ams',  // should be 'ams', 'none', or 'all' 
        }
    };
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
            extensions: ["mhchem.js", "glossaries.jl"],
          }
      });
</script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap');
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../_styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ExESS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" rel="" target="" aria-current="page">
 <span class="menu-text"><i class="fa-solid fa-house" aria-label="house"></i> Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../documentation/documentation.html" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-book" aria-label="book"></i> Documentation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../manuals/manuals.html" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-bookmark" aria-label="bookmark"></i> Manuals &amp; Examples</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../api/api.html" rel="" target="">
 <span class="menu-text"><i class="fa-solid fa-code" aria-label="code"></i> Code</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Smolkaa" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../documentation/fundamentals/coordinate_systems.html">2. Fundamentals</a></li><li class="breadcrumb-item"><a href="../../documentation/fundamentals/coordinate_systems.html">2.1 Coordinate Systems</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../resources/logo/exess_logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/documentation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/acronyms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acronyms</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/introduction/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">2. Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/fundamentals/coordinate_systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">2.1 Coordinate Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/fundamentals/numerical_grids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.2 Numerical Grids</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">2.3. ODEs and Numerical Solvers</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/fundamentals/stats_mc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.4 Statistics and Monte-Carlo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/fundamentals/moon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2.5 The Moon</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">2.6. Other Exospheres in The Solar System</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">3. Planetary Measurements and Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/planetary_measurements/missions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.1 Missions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/planetary_measurements/lunar_exosphere_densities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3.2 Lunar Exosphere Surface Densities</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">4. Exospheres: Sources and Sinks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
 <span class="menu-text">4.1. Solar Wind</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/sources_sinks/thermal_sorption.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.2 Thermal Sorption</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/sources_sinks/photoionization_dissociation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4.3 Photoionization &amp; -dissociation</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">Photodesorption</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">MIV</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">5. Exospheres: Particle Trajectories</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/trajectories/ballistic_trajectories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.1 Ballistic Trajectories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documentation/trajectories/non-ballistic_trajectories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5.2 Non-Ballistic Trajectories</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">6. Lunar Water Exosphere Simulation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
 <span class="menu-text">6.X Hydrogen Surface Reaction Model</span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">2.1 Coordinate Systems</h2>
   
  <ul>
  <li><a href="#cartesian-and-spherical-coordinates" id="toc-cartesian-and-spherical-coordinates" class="nav-link active" data-scroll-target="#cartesian-and-spherical-coordinates">Cartesian and Spherical Coordinates</a></li>
  <li><a href="#spacial-differentials" id="toc-spacial-differentials" class="nav-link" data-scroll-target="#spacial-differentials">Spacial Differentials</a></li>
  <li><a href="#temporal-differentials" id="toc-temporal-differentials" class="nav-link" data-scroll-target="#temporal-differentials">Temporal Differentials</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Smolkaa/smolkaa.github.io/edit/main/documentation/fundamentals/coordinate_systems.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">2.1 Coordinate Systems</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p></p><p>Alexander Smolka, <a href="mailto:a.smolka@tum.de"><code>a.smolka@tum.de</code></a> <br> Technical University of Munich</p> <p></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 2, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!-- SIUNITX WORKAROUND -->
<!-- GLS WORKAROUND -->
<hr>
<p>Some introduction text…</p>
<section id="cartesian-and-spherical-coordinates" class="level1 page-columns page-full">
<h1>Cartesian and Spherical Coordinates</h1>
<p>A clear distinction has been made between cartesian and spherical coordinates and cartesian and spherical elements. The former are used to describe the domain in which the vector is defined, while the latter are used to describe the vector and its components itself. For example, a position vector in a cartesian coordinate system, <span class="math inline">\(\boldsymbol{\mathbf{x}}\)</span>, can be expressed in cartesian elements <span class="math inline">\(\left(x, y, z\right)\)</span>, which are the x-, y-, and z-components of the vector: <span class="math display">\[\begin{equation}
    \boldsymbol{\mathbf{x}}= \begin{bmatrix}
        x\\
        y\\
        z
    \end{bmatrix} \qquad\text{with } x\in\mathbb{R},\;y\in\mathbb{R},\;z\in\mathbb{R}.
    \label{eq:cartesian_coordinate}
\end{equation}\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Vectors defining a position or a velocity in a <strong>cartesian</strong> coordinate system and in <strong>cartesian</strong> elements, like the one shown in Eq. <span class="math inline">\(\eqref{eq:cartesian_coordinate}\)</span>:</p>
<p><i class="fa-solid fa-code" aria-label="code"></i> <a href="../../api/base/cs.html"><code>GlobalCartesianPosition</code></a></p>
<p><i class="fa-solid fa-code" aria-label="code"></i> <a href="../../api/base/cs.html"><code>GlobalCartesianVelocity</code></a></p>
</div></div><p>The same vector in the same coordinate system and, thus, the same domain, can also be expressed used spherical elements <span class="math inline">\(\left(r, \vartheta, \varphi\right)\)</span>, which are the radial, azimuthal, and elevation components of the vector: <span class="math display">\[\begin{equation}
    \boldsymbol{\mathbf{x}}_s = \begin{bmatrix}
        r\cos\vartheta\cos\varphi\\
        r\sin\vartheta\cos\varphi\\
        r\sin\varphi
    \end{bmatrix} \qquad\text{with }r\in\mathbb{R}^+,\;\vartheta\in\left[-\pi,\pi\right),\;\varphi\in\left[-\frac{\pi}{2},\frac{\pi}{2}\right].
\end{equation}\]</span> Note that the subscript <span class="math inline">\(s\)</span> indicates that the vector is expressed in spherical elements. Both vectors describe the same coordinate in the same coordinate system, thus <span class="math inline">\(\boldsymbol{\mathbf{x}}= \boldsymbol{\mathbf{x}}_s\)</span>. On the other hand, a coordinate can also be projected into a spherical coordiante system, <span class="math inline">\(\boldsymbol{\mathbf{r}}\)</span>, which is a different domain, and expressed in spherical elements <span class="math inline">\(\left(r, \vartheta, \varphi\right)\)</span>: <span class="math display">\[\begin{equation}
    \boldsymbol{\mathbf{r}}= \begin{bmatrix}r\\ \vartheta\\ \varphi\end{bmatrix} \qquad\text{with }r\in\mathbb{R}^+,\;\vartheta\in\left[-\pi,\pi\right),\;\varphi\in\left[-\frac{\pi}{2},\frac{\pi}{2}\right].
    \label{eq:spherical_coordinate}
\end{equation}\]</span></p>
<p>The same coordinate can also be expressed in cartesian elements <span class="math inline">\(\left(x, y, z\right)\)</span>: <span class="math display">\[\begin{equation}
    \boldsymbol{\mathbf{r}}_c = \begin{bmatrix}
        \sqrt{x^2 + y^2 + z^2} \\
        \mathop{\mathrm{sgn}}\left(y\right)\cdot\cos^{-1}\left(\frac{x}{\sqrt{x^2 + y^2}}\right)\\
        \sin^{-1}\left(\frac{z}{\sqrt{x^2 + y^2 + z^2}}\right)
    \end{bmatrix}  \qquad\text{with } x\in\mathbb{R},\;y\in\mathbb{R},\;z\in\mathbb{R}.
\end{equation}\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Vectors defining a position or a velocity in a <strong>spherical</strong> coordinate system and in <strong>spherical</strong> elements, like the one shown in Eq. <span class="math inline">\(\eqref{eq:spherical_coordinate}\)</span>:</p>
<p><i class="fa-solid fa-code" aria-label="code"></i> <a href="../../api/base/cs.html"><code>GlobalSphericalPosition</code></a></p>
<p><i class="fa-solid fa-code" aria-label="code"></i> <a href="../../api/base/cs.html"><code>GlobalSphericalVelocity</code></a></p>
</div></div><p>Note that the subscript <span class="math inline">\(c\)</span> indicates that the vector is expressed in cartesian elements. Both vectors describe the same coordinate in the same coordinate system, thus <span class="math inline">\(\boldsymbol{\mathbf{r}}= \boldsymbol{\mathbf{r}}_c\)</span>. Even though, physically speaking, all four coordinate vectors can describe the same position in physical space, mathematically speaking, they are different vectors, thus: <span class="math inline">\(\boldsymbol{\mathbf{x}}= \boldsymbol{\mathbf{x}}_s \neq \boldsymbol{\mathbf{r}}= \boldsymbol{\mathbf{r}}_c\)</span>. The following sections will go into more detail about the differences of these coordinate systems, where the names and are used to describe the domain and not the elements.</p>
<p>All coordinate vectors can also be written as a sum of scaled base vectors, where the base vectors are the unit vectors of the respective coordinate system. The base vectors of any cartesian coordinate system are: <span class="math display">\[\begin{equation}
    \hat{\boldsymbol{\mathbf{e}}}_x= \begin{bmatrix}1 \\ 0 \\ 0 \end{bmatrix} \text{,}\qquad
    \hat{\boldsymbol{\mathbf{e}}}_y= \begin{bmatrix}0 \\ 1 \\ 0 \end{bmatrix} \text{,}\qquad\text{and}\qquad
    \hat{\boldsymbol{\mathbf{e}}}_z= \begin{bmatrix}0 \\ 0 \\ 1 \end{bmatrix},
\end{equation}\]</span> which leads to the following expression for the cartesian coordinate vector, for both in cartesian and spherical elements: <span class="math display">\[\begin{align}
    \boldsymbol{\mathbf{x}}&amp;= x\hat{\boldsymbol{\mathbf{e}}}_x+ y\hat{\boldsymbol{\mathbf{e}}}_y+ z\hat{\boldsymbol{\mathbf{e}}}_z\nonumber \\
    &amp;= \left(r\cos\vartheta\cos\varphi\right)\hat{\boldsymbol{\mathbf{e}}}_x+ \left(r\sin\vartheta\cos\varphi\right) \hat{\boldsymbol{\mathbf{e}}}_y+ \left(r\sin\varphi\right) \hat{\boldsymbol{\mathbf{e}}}_z= \boldsymbol{\mathbf{x}}_s.
\end{align}\]</span> Similarly, the base vectors of any spherical coordinate system are: <span class="math display">\[\begin{equation}
    \hat{\boldsymbol{\mathbf{e}}}_r= \begin{bmatrix}1 \\ 0 \\ 0 \end{bmatrix} \text{,}\qquad
    \hat{\boldsymbol{\mathbf{e}}}_\vartheta= \begin{bmatrix}0 \\ 1 \\ 0 \end{bmatrix} \text{,}\qquad\text{and}\qquad
    \hat{\boldsymbol{\mathbf{e}}}_\varphi= \begin{bmatrix}0 \\ 0 \\ 1 \end{bmatrix},
\end{equation}\]</span> which leads to the following expression for the spherical coordinate vector, for both in cartesian and spherical elements: <span class="math display">\[\begin{align}
    \boldsymbol{\mathbf{r}}&amp;= r\hat{\boldsymbol{\mathbf{e}}}_r+ \vartheta\hat{\boldsymbol{\mathbf{e}}}_\vartheta+ \varphi\hat{\boldsymbol{\mathbf{e}}}_\varphi\nonumber \\
    &amp;= \left(\sqrt{x^2 + y^2 + z^2}\right)\hat{\boldsymbol{\mathbf{e}}}_r\nonumber \\
    &amp;+ \left(\mathop{\mathrm{sgn}}\left(y\right)\cdot\cos^{-1}\left(\frac{x}{\sqrt{x^2 + y^2}}\right)\right) \hat{\boldsymbol{\mathbf{e}}}_\vartheta\nonumber \\
    &amp;+ \left(\sin^{-1}\left(\frac{z}{\sqrt{x^2 + y^2 + z^2}}\right)\right) \hat{\boldsymbol{\mathbf{e}}}_\varphi\\
    &amp;= \boldsymbol{\mathbf{r}}_c.\nonumber
\end{align}\]</span></p>
<p>Due to the equalities of the vectors in their respective same coordinate system, the rest of this work will only use <span class="math inline">\(\boldsymbol{\mathbf{x}}\)</span> and <span class="math inline">\(\boldsymbol{\mathbf{r}}\)</span> without their indexed counterparts. The element type will be indicated by the context of the equation.</p>
</section>
<section id="spacial-differentials" class="level1 page-columns page-full">
<h1>Spacial Differentials</h1>
<p>This work is regularly relying on vector calculus which includes a substantial use of differentials and derivatives. The former uses two kinds of notations, depending on the use case of the differential. First, mathematical differentials of vectors are the vectorized form of the differentials of the vector components. In the following, the differentials will be set up for stationary conditions with constant base vectors, i.e.</p>
<p><span class="math display">\[\begin{align}
    \frac{\partial}{\partial t} &amp;= 0, \\
    \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_x}{\partial r} &amp;= \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_x}{\partial\vartheta} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_x}{\partial\varphi} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_y}{\partial r} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_y}{\partial\vartheta} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_y}{\partial\varphi} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_z}{\partial r} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_z}{\partial\vartheta} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_z}{\partial\varphi} = 0, \\
    \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_r}{\partial x} &amp;= \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_r}{\partial y} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_r}{\partial z} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\vartheta}{\partial x} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\vartheta}{\partial y} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\vartheta}{\partial z} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\varphi}{\partial x} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\varphi}{\partial y} = \frac{\partial\hat{\boldsymbol{\mathbf{e}}}_\varphi}{\partial z} = 0.
\end{align}\]</span></p>
<p>For example, the differential of a stationary cartesian coordinate vector and cartesian elements is</p>
<p><span class="math display">\[\begin{equation}
    d\boldsymbol{\mathbf{x}}= \frac{\partial\boldsymbol{\mathbf{x}}}{\partial x}dx+ \frac{\partial\boldsymbol{\mathbf{x}}}{\partial y}dy+ \frac{\partial\boldsymbol{\mathbf{x}}}{\partial z}dz= dx\hat{\boldsymbol{\mathbf{e}}}_x+ dy\hat{\boldsymbol{\mathbf{e}}}_y+ dz\hat{\boldsymbol{\mathbf{e}}}_z= \begin{bmatrix} dx\\ dy\\ dz\end{bmatrix},
\end{equation}\]</span></p>
<p>and for spherical coordinates and elements</p>
<p><span class="math display">\[\begin{equation}
    d\boldsymbol{\mathbf{r}}= \frac{\partial\boldsymbol{\mathbf{r}}}{\partial r}dr+ \frac{\partial\boldsymbol{\mathbf{r}}}{\partial\vartheta}d\vartheta+ \frac{\partial\boldsymbol{\mathbf{r}}}{\partial\varphi}d\varphi= dr\hat{\boldsymbol{\mathbf{e}}}_r+ d\vartheta\hat{\boldsymbol{\mathbf{e}}}_\vartheta+ d\varphi\hat{\boldsymbol{\mathbf{e}}}_\varphi= \begin{bmatrix} dr\\ d\vartheta\\ d\varphi\end{bmatrix}.
\end{equation}\]</span></p>
<p>The above total differentials are relatively simple to set up since their respective partial differentials cancel out to only contain one variable each. However, the differentials for the cartesian vector in spherical elements and the spherical vector in cartesian elements are more complicated, with the former differential given by</p>
<p><span class="math display">\[\begin{align}
    d\boldsymbol{\mathbf{x}}&amp;= \frac{\partial\boldsymbol{\mathbf{x}}}{\partial r}dr+ \frac{\partial\boldsymbol{\mathbf{x}}}{\partial\vartheta}d\vartheta+ \frac{\partial\boldsymbol{\mathbf{x}}}{\partial\varphi}d\varphi\\
    &amp;= \left(\cos\vartheta\cos\varphi\hat{\boldsymbol{\mathbf{e}}}_x+ \sin\vartheta\cos\varphi\hat{\boldsymbol{\mathbf{e}}}_y+ \sin\varphi\hat{\boldsymbol{\mathbf{e}}}_z\right) dr\nonumber \\
    &amp;+ \left(-r\sin\vartheta\cos\varphi\hat{\boldsymbol{\mathbf{e}}}_x+ r\cos\vartheta\cos\varphi\hat{\boldsymbol{\mathbf{e}}}_y\right) d\vartheta\nonumber \\
    &amp;+ \left(-r\cos\vartheta\sin\varphi\hat{\boldsymbol{\mathbf{e}}}_x- r\sin\vartheta\sin\varphi\hat{\boldsymbol{\mathbf{e}}}_y+ r\cos\varphi\hat{\boldsymbol{\mathbf{e}}}_z\right) d\varphi\\
    &amp;= \begin{bmatrix}
        \cos\vartheta\cos\varphi&amp;  -r\sin\vartheta\cos\varphi&amp; -r\cos\vartheta\sin\varphi\\
        \sin\vartheta\cos\varphi&amp; r\cos\vartheta\cos\varphi&amp; - r\sin\vartheta\sin\varphi\\
        \sin\varphi&amp; 0 &amp; r\cos\varphi
    \end{bmatrix} \begin{bmatrix} dr\\ d\vartheta\\ d\varphi\end{bmatrix}  \label{eq:total_cartesian_spherical_differential_matrix}\\
    &amp;= \begin{bmatrix}
        \cos\vartheta\cos\varphi dr-r\sin\vartheta\cos\varphi d\vartheta-r\cos\vartheta\sin\varphi d\varphi\\
        \sin\vartheta\cos\varphi dr+ r\cos\vartheta\cos\varphi d\vartheta- r\sin\vartheta\sin\varphi d\varphi\\
        \sin\varphi dr+ r\cos\varphi d\varphi
    \end{bmatrix}. \label{eq:total_cartesian_spherical_differential}
\end{align}\]</span></p>
<p>The resulting vector in Eq. <span class="math inline">\(\eqref{eq:total_cartesian_spherical_differential}\)</span> contains the scalar differentials of the spherical elements in each of its entries, which can also be pulled out of the vector and written as a linear combination using a matrix notation, shown in Eq. <span class="math inline">\(\eqref{eq:total_cartesian_spherical_differential_matrix}\)</span>. While the differential of a spherical vector in cartesian elements can be calculated in the same way, which is <span class="math inline">\(d\boldsymbol{\mathbf{r}}= \frac{\partial\boldsymbol{\mathbf{r}}}{\partial x}dx+ \frac{\partial\boldsymbol{\mathbf{r}}}{\partial y}dy+ \frac{\partial\boldsymbol{\mathbf{r}}}{\partial z}dz\)</span>, its trigonometric functions and subsequent differentiations make it less common and inefficient to use, which is why it is not shown here for brevity.</p>
<p>These vectorized total differentials are regularly used in vector calculus. A prime example is calculating the gradient <span class="math inline">\(\nabla\)</span> of a scalar function <span class="math inline">\(f\)</span>, which is given by <span class="math display">\[\begin{equation}
    \frac{df}{d\boldsymbol{\mathbf{x}}} = \nabla f = \begin{bmatrix}
        \frac{\partial f}{\partial x} \\
        \frac{\partial f}{\partial y} \\
        \frac{\partial f}{\partial z}
    \end{bmatrix},
\end{equation}\]</span> as an example in a cartesian coordinate system and with cartesian elements. Many problems feature the second-order derivatives of a scalar function, which is called the Laplacian <span class="math inline">\(\nabla^2\)</span> and is given by <span class="math display">\[\begin{equation}
    \nabla \cdot \nabla f = \nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} + \frac{\partial^2 f}{\partial z^2}.
\end{equation}\]</span></p>
<p>Both the gradient and the laplacian can also be expressed in spherical coordinates. The former makes use of the chain rule of differentiation, which evaluates to the inverse matrix of the coordinate projection of Eq. <span class="math inline">\(\eqref{eq:total_cartesian_spherical_differential_matrix}\)</span>: <span class="math display">\[\begin{align}
    \begin{bmatrix}
        \frac{\partial}{\partial x} \\
        \frac{\partial}{\partial y} \\
        \frac{\partial}{\partial z}
    \end{bmatrix} &amp;= \begin{bmatrix}
        \frac{\partial r}{\partial x} &amp; \frac{\partial\vartheta}{\partial x} &amp; \frac{\partial\varphi}{\partial x} \\
        \frac{\partial r}{\partial y} &amp; \frac{\partial\vartheta}{\partial y} &amp; \frac{\partial\varphi}{\partial y} \\
        \frac{\partial r}{\partial z} &amp; \frac{\partial\vartheta}{\partial z} &amp; \frac{\partial\varphi}{\partial z}
    \end{bmatrix}\begin{bmatrix}
        \frac{\partial}{\partial r} \\
        \frac{\partial}{\partial\vartheta} \\
        \frac{\partial}{\partial\varphi}
    \end{bmatrix} \\
    &amp;= \begin{bmatrix}
        \cos\vartheta\cos\varphi&amp; -\frac{\sin\vartheta}{r\cos\varphi} &amp; -\frac{\cos\vartheta\sin\varphi}{r} \\
        \sin\vartheta\cos\varphi&amp; \frac{\cos\vartheta}{r\cos\varphi} &amp; -\frac{\sin\vartheta\sin\varphi}{r} \\
        \sin\varphi&amp; 0 &amp; \frac{\cos\varphi}{r}
    \end{bmatrix}\begin{bmatrix}
        \frac{\partial}{\partial r} \\
        \frac{\partial}{\partial\vartheta} \\
        \frac{\partial}{\partial\varphi}
    \end{bmatrix}\\
    \Rightarrow\qquad \frac{\partial}{\partial x} &amp;= \cos\vartheta\cos\varphi\frac{\partial}{\partial r} -\frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \label{eq:spherical_gradient_x}\\
    \Rightarrow\qquad \frac{\partial}{\partial y} &amp;= \sin\vartheta\cos\varphi\frac{\partial}{\partial r} + \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \label{eq:spherical_gradient_y}\\
    \Rightarrow\qquad \frac{\partial}{\partial z} &amp;= \sin\varphi\frac{\partial}{\partial r} + \frac{\cos\varphi}{r} \frac{\partial}{\partial\varphi}. \label{eq:spherical_gradient_z}
\end{align}\]</span> The latter can be derived by applying the chain rule twice, which is a tedious but straightforward calculation, leading to: <span class="math display">\[\begin{align}
    \nabla^2 &amp;= \frac{\partial^2}{\partial r^2} + \frac{2}{r}\frac{\partial}{\partial r} + \frac{1}{r^2\cos^2\varphi}\frac{\partial}{\partial\vartheta} + \frac{1}{r^2} \frac{\partial^2}{\partial\varphi^2} - \frac{\sin\varphi}{r^2\cos\varphi} \frac{\partial}{\partial\varphi} \\
    &amp;= \frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right) + \frac{1}{r^2\cos^2\varphi}\frac{\partial}{\partial\vartheta} + \frac{1}{r^2\cos\varphi} \frac{\partial}{\partial\varphi} \left(\cos\varphi\frac{\partial}{\partial\varphi}\right). \label{eq:laplace_spherical}
\end{align}\]</span></p>
<div class="column-page-right callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Derivation of spherical Laplace operator.
</div>
</div>
<div class="callout-body-container callout-body">
<p>The laplacian is the linear summation of the second-order cartesian partial derivative <span class="math inline">\(\nabla^2 = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}\)</span>. The spherical laplacian can be derived by applying the chain rule of partial derivatives, shown in the gradient derivation in Eqs. <span class="math inline">\(\eqref{eq:spherical_gradient_x}\)</span>, <span class="math inline">\(\eqref{eq:spherical_gradient_y}\)</span>, <span class="math inline">\(\eqref{eq:spherical_gradient_z}\)</span> twice: <span class="math display">\[\begin{align*}
    \frac{\partial^2}{\partial x^2} &amp;= \cos\vartheta\cos\varphi\frac{\partial}{\partial r}\frac{\partial}{\partial x} -\frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta}\frac{\partial}{\partial x} -\frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi}\frac{\partial}{\partial x} \\
    &amp;= \cos\vartheta\cos\varphi\frac{\partial}{\partial r} \left( \cos\vartheta\cos\varphi\frac{\partial}{\partial r} -\frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi}\right) \\
    &amp;- \frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} \left( \cos\vartheta\cos\varphi\frac{\partial}{\partial r} -\frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \right) \\
    &amp;- \frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \left( \cos\vartheta\cos\varphi\frac{\partial}{\partial r} -\frac{\sin\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\cos\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \right) \\
    %
    \frac{\partial^2}{\partial y^2} &amp;= \sin\vartheta\cos\varphi\frac{\partial}{\partial r}\frac{\partial}{\partial y} + \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta}\frac{\partial}{\partial y} -\frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi}\frac{\partial}{\partial y} \\
    &amp;= \sin\vartheta\cos\varphi\frac{\partial}{\partial r} \left( \sin\vartheta\cos\varphi\frac{\partial}{\partial r} + \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \right) \\
    &amp;+ \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} \left( \sin\vartheta\cos\varphi\frac{\partial}{\partial r} + \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \right) \\
    &amp;- \frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \left( \sin\vartheta\cos\varphi\frac{\partial}{\partial r} + \frac{\cos\vartheta}{r\cos\varphi} \frac{\partial}{\partial\vartheta} -\frac{\sin\vartheta\sin\varphi}{r} \frac{\partial}{\partial\varphi} \right) \\
    %
    \frac{\partial^2}{\partial z^2} &amp;= \sin\varphi\frac{\partial}{\partial r}\frac{\partial}{\partial z} + \frac{\cos\varphi}{r} \frac{\partial}{\partial\varphi}\frac{\partial}{\partial z} \\
    &amp;= \sin\varphi\frac{\partial}{\partial r} \left( -\sin\varphi\frac{\partial}{\partial r} + \frac{\cos\varphi}{r} \frac{\partial}{\partial\varphi} \right) + \frac{\cos\varphi}{r} \frac{\partial}{\partial\varphi} \left( -\sin\varphi\frac{\partial}{\partial r} + \frac{\cos\varphi}{r} \frac{\partial}{\partial\varphi} \right).
\end{align*}\]</span> Evaluating all partial derivatives and summing up all terms leads to a miraculous cancellation of terms, finally arriving at the following expression of Eq.~(<span class="math inline">\(\ref{eq:laplace_spherical}\)</span>) for the Laplacian in spherical coordinates: <span class="math display">\[\begin{align*}
    \nabla^2 &amp;= \frac{\partial^2}{\partial r^2} + \frac{2}{r}\frac{\partial}{\partial r} + \frac{1}{r^2\cos^2\varphi}\frac{\partial}{\partial\vartheta} + \frac{1}{r^2} \frac{\partial^2}{\partial\varphi^2} - \frac{\sin\varphi}{r^2\cos\varphi} \frac{\partial}{\partial\varphi} \\
    &amp;= \frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right) + \frac{1}{r^2\cos^2\varphi}\frac{\partial}{\partial\vartheta} + \frac{1}{r^2\cos\varphi} \frac{\partial}{\partial\varphi} \left(\cos\varphi\frac{\partial}{\partial\varphi}\right).
\end{align*}\]</span></p>
</div>
</div>
<p>Another example of the use of differentials is in integration, where it is used to represent an infinitesimal change in the variable. Shorthand versions of multi-dimensional integrals are often written using vector variables, such as <span class="math display">\[\begin{equation}
    \int_X \int_Y \int_Z f dzdydx= \int_Vf d^3\boldsymbol{\mathbf{x}},
\end{equation}\]</span> where <span class="math inline">\(V\)</span> is the volume of the integration domain, with the infinitesimal volume element <span class="math inline">\(d^3\boldsymbol{\mathbf{x}}\in V= \left\{dx\, dy\, dz\; | \; dx\in X, dy\in Y, dz\in Z \right\}\)</span>. The superscript <span class="math inline">\(\bullet^3\)</span> in the differentials indicates that the differential is a vector but a scalar representation of the element’s size created by the vector elements. As before, the differential <span class="math inline">\(d^3\boldsymbol{\mathbf{x}}\)</span> can also be expressed in spherical elements by using the Jacobian determinant, which is equal to the matrix of Eq. <span class="math inline">\(\eqref{eq:total_cartesian_spherical_differential_matrix}\)</span>, of the transformation: <span class="math display">\[\begin{equation}
    d^3\boldsymbol{\mathbf{x}}= \left|\frac{\partial\boldsymbol{\mathbf{x}}}{\partial\boldsymbol{\mathbf{r}}}\right| d^3\boldsymbol{\mathbf{r}}= r^2\cos\varphi drd\vartheta d\varphi.
\end{equation}\]</span> <a href="#fig-spherical_differential_element">Figure&nbsp;1</a> illustrates the spherical differential element <span class="math inline">\(d^3\boldsymbol{\mathbf{r}}\)</span> in a three-dimensional cartesian coordinate system. The azimuth angle <span class="math inline">\(\vartheta\)</span> rotates inside of the <span class="math inline">\(x\)</span>–<span class="math inline">\(y\)</span> plane, while the elevation angle <span class="math inline">\(\varphi\)</span> rotates the vector out of that plane in <span class="math inline">\(z\)</span> direction. While the azimuth arc decreases with the sine of the elevation angle, the small angle approximation can be used to approximate the differential element as a cuboid with the volume <span class="math inline">\(d^3\boldsymbol{\mathbf{r}}\approx r^2 \sin\varphi\, drd\vartheta d\varphi\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset column-page-right page-columns page-full">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><i class="fa-solid fa-image" aria-label="image"></i> Figure</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><i class="fa-solid fa-code" aria-label="code"></i> LaTeX</a></li></ul>
<div class="tab-content column-page-right">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="fig-spherical_differential_element" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../../documentation/fundamentals/coordinate_systems/imgs/spherical_differential_element/spherical_differential_element.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="../..\documentation/fundamentals/coordinate_systems/imgs/spherical_differential_element/spherical_differential_element.svg" class="img-fluid figure-img" width="600"></a></p>
</figure>
</div>
<figcaption class="figure-caption">Figure&nbsp;1: Three-dimensional sketch of a spherical differential element in a cartesian coordinate system.</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb1"><pre class="sourceCode latex code-with-copy"><code class="sourceCode latex"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">% based on: https://tikz.net/spherical_volume/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">%Axis Angles</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">\tdplotsetmaincoords</span>{70}{110}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">%Macros</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\rvec</span>}{6}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\elevationvec</span>}{40}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\azimuthvec</span>}{45}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\dazimuthvec</span>}{20}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\delevationvec</span>}{20}</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfmathsetmacro</span>{<span class="fu">\drvec</span>}{1.5}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">%Layers</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfdeclarelayer</span>{background}</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfdeclarelayer</span>{foreground}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">\pgfsetlayers</span>{background, main, foreground}</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">\begin</span>{<span class="ex">tikzpicture</span>}[tdplot_main_coords]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Coordinates</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\coordinate</span> (O) at (0,0,0);</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{A}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{B}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{C}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{D}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{E}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{F}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{F'}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{90}{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{G}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{G'}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{90}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">\tdplotsetcoord</span>{H}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Axis</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{background}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick,-latex] (0,0,0) -- (7,0,0) node[pos=1.1]{<span class="ss">$</span><span class="sc">\cartesianCoordinateX</span><span class="ss">$</span>};</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick,-latex] (0,0,0) -- (0,7,0) node[pos=1.05]{<span class="ss">$</span><span class="sc">\cartesianCoordinateY</span><span class="ss">$</span>};</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick,-latex] (0,0,0) -- (0,0,6) node[pos=1.05]{<span class="ss">$</span><span class="sc">\cartesianCoordinateZ</span><span class="ss">$</span>};</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Help Lines</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{background}</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Up</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick, black] (O) -- (A) node[pos=0.6, above left, black] {<span class="ss">$</span><span class="sc">\sphericalCoordinateRadius</span><span class="ss">$</span>};</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span> (O) -- (B);</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span> (O) -- (C);</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[dashed] (O) -- (D);</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Down</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span> (O) -- (F');</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span> (O) -- (G');</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{foreground}</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="co">%%Help Curves</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords]{(O)}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec+\delevationvec</span>}{90}{}{}</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords]{(O)}{<span class="fu">\rvec+\drvec</span>}{<span class="fu">\elevationvec+\delevationvec</span>}{90}{}{}</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec+\dazimuthvec</span>}</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, dashed]{(O)}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec+\delevationvec</span>}{90}{}{}</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords]{(O)}{<span class="fu">\rvec+\drvec</span>}{<span class="fu">\elevationvec+\delevationvec</span>}{90}{}{}</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>        <span class="co">%</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_main_coords]{(O)}{<span class="fu">\rvec</span>}{<span class="fu">\azimuthvec</span>}{<span class="fu">\azimuthvec+\dazimuthvec</span>}{}{}</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\node</span>[rotate=13] at (3,4.45,0) {<span class="ss">$</span><span class="sc">\sphericalCoordinateRadius\sin\sphericalCoordinateElevation</span><span class="ss"> d</span><span class="sc">\sphericalCoordinateAzimuth</span><span class="ss">$</span>};</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_main_coords]{(O)}{<span class="fu">\rvec+\drvec</span>}{<span class="fu">\azimuthvec</span>}{<span class="fu">\azimuthvec+\dazimuthvec</span>}{}{}</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Angles</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{foreground}</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Phi, dPhi</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[-stealth]{(O)}{0.9}{0}{<span class="fu">\azimuthvec</span>}{anchor=north}{<span class="ss">$</span><span class="sc">\sphericalCoordinateAzimuth</span><span class="ss">$</span>}</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[-stealth]{(O)}{1.5}{<span class="fu">\azimuthvec</span>}{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}{}{}</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\node</span> at (1.4,1.9,0) {<span class="ss">$ d</span><span class="sc">\sphericalCoordinateAzimuth</span><span class="ss">$</span>};</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Theta, dTheta</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, -stealth]{(0,0,0)}{1.2}{90}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{}{}</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>        <span class="co">%\node at (0,0.3,1.3) {$\sphericalCoordinateElevation$};</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\node</span> at (1,1.25,0.55) {<span class="ss">$</span><span class="sc">\sphericalCoordinateElevation</span><span class="ss">$</span>};</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, stealth-]{(0,0,0)}{2.}{<span class="fu">\elevationvec</span>}{<span class="fu">\elevationvec</span> + <span class="fu">\delevationvec</span>}{anchor=south west}{<span class="ss">$ d</span><span class="sc">\sphericalCoordinateElevation</span><span class="ss">$</span>}</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Differential Volume</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%Lines</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{foreground}</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick] (A) -- (E) node[midway, above left]{<span class="ss">$ d</span><span class="sc">\sphericalCoordinateRadius</span><span class="ss">$</span>};</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick] (B) -- (F);</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[thick] (C) -- (G);</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{background}</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\draw</span>[dashed, thick] (D) -- (H);</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">%%Curved</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{background}</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetrotatedcoords</span>{55}{-50.4313}{-6.4086}</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[dashed, tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span>}{0}{12.8173}{}{}</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        <span class="co">%</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[dashed, tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\delevationvec</span> + <span class="fu">\elevationvec</span>}{}{}</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{foreground}</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec</span>}</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\delevationvec</span> + <span class="fu">\elevationvec</span>}{below left}{<span class="ss">$</span><span class="sc">\sphericalCoordinateRadius</span><span class="ss"> d</span><span class="sc">\sphericalCoordinateElevation</span><span class="ss">$</span>}</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\delevationvec</span> + <span class="fu">\elevationvec</span>}{}{}</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>        <span class="co">%</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetthetaplanecoords</span>{<span class="fu">\azimuthvec</span> + <span class="fu">\dazimuthvec</span>}</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{<span class="fu">\elevationvec</span>}{<span class="fu">\delevationvec</span> + <span class="fu">\elevationvec</span>}{}{}</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>        <span class="co">%</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetrotatedcoords</span>{55}{-50.4313}{-6.4086}</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{0}{12.8173}{}{}</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>        <span class="co">%</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotsetrotatedcoords</span>{55}{-30.3813}{-8.6492}</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span>}{0}{17.2983}{}{}</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\tdplotdrawarc</span>[tdplot_rotated_coords, thick]{(O)}{<span class="fu">\rvec</span> + <span class="fu">\drvec</span>}{0}{17.2983}{}{}</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Fill Color</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{main}</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Front</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black, opacity=0.15] (E) to (A)  to[bend left=4] (B) to (F) to[bend right=4] cycle;</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black, opacity=0.6] (E) to[bend left=4] (F)  to[bend left=2] (G) to[bend right=6.5] (H) to[bend right=4] cycle;</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black, opacity=0.4] (F) to[bend left=2] (G) to[bend left=1.5] (C) to[bend right=2.5] (B) to[bend right=4] cycle;</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>        <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\begin</span>{<span class="ex">pgfonlayer</span>}{background}</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>        <span class="co">%Back</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black!50, opacity=0.5] (A) to[bend left=2] (D) to[bend left=6] (C) to[bend right=2.5] (B) to[bend right=4] cycle;</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black!50, opacity=0.5] (A) to[bend left=2] (D) to (H) to[bend right=2.5] (E) to[bend right=4] cycle;</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>        <span class="fu">\fill</span>[black!50, opacity=0.5] (D) to (H) to[bend left=6] (G) to[bend right=2] (C) to[bend right=6] cycle;</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">\end</span>{<span class="ex">pgfonlayer</span>}</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="kw">\end</span>{<span class="ex">tikzpicture</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="temporal-differentials" class="level1">
<h1>Temporal Differentials</h1>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{smolka2023,
  author = {Smolka, Alexander},
  title = {ExESS - {Extraterrestrial} {Exosphere} and {Surface}
    {Simulations}},
  date = {2023},
  url = {https://smolkaa.github.io},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-smolka2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Smolka, A. (2023). <em>ExESS - Extraterrestrial Exosphere and Surface
Simulations</em>. <a href="https://smolkaa.github.io">https://smolkaa.github.io</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../documentation/introduction/introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">1. Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../documentation/fundamentals/numerical_grids.html" class="pagination-link">
        <span class="nav-page-text">2.2 Numerical Grids</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":true});</script>



</body></html>