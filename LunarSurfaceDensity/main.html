<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Main · ExosphereSimulations.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ExosphereSimulations.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Base</span><ul><li><a class="tocitem" href="../ballistic_2d.html"><strong>B</strong>allistic Flight - 2D</a></li><li><a class="tocitem" href="../residence_time.html"><strong>R</strong>esidence Time</a></li><li><a class="tocitem" href="../solar_angle.html"><strong>S</strong>olar Angle</a></li><li><a class="tocitem" href="../spherical_grids.html"><strong>S</strong>pherical Grids</a></li><li><a class="tocitem" href="../temperatures.html"><strong>T</strong>emperatures</a></li><li><a class="tocitem" href="../utils.html"><strong>U</strong>tility</a></li><li><a class="tocitem" href="../velocity_distribution.html"><strong>V</strong>elocity Distributions</a></li></ul></li><li><span class="tocitem">Lunar Surface Density Simulation</span><ul><li class="is-active"><a class="tocitem" href="main.html">Main</a></li><li><a class="tocitem" href="input.html">Input</a></li><li><a class="tocitem" href="example.html">Example</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lunar Surface Density Simulation</a></li><li class="is-active"><a href="main.html">Main</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="main.html">Main</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com//blob/master/docs/src/LunarSurfaceDensity/main.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lunar-Surface-Density"><a class="docs-heading-anchor" href="#Lunar-Surface-Density">Lunar Surface Density</a><a id="Lunar-Surface-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Lunar-Surface-Density" title="Permalink"></a></h1><p>Firstly, the <code>ExosphereSimulations.jl</code> package has to be loaded to be able to use its entire functionality:</p><pre><code class="language-julia hljs">include(joinpath(path, to, repository, &quot;src&quot;, &quot;ExosphereSimulations.jl&quot;))
using .ExosphereSimulations</code></pre><p>Now, both the base functions, as well as the sub-module <a href="main.html#ExosphereSimulations.LunarSurfaceDensity"><code>LunarSurfaceDensity</code></a> with all of its functionality are available. The usual workflow for setting up and running a simulation is based on first defining the problem using the <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.LSDProblem"><code>LSDProblem</code></a> constructor and then solving the problem using the <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.solve"><code>solve</code></a> function.</p><pre><code class="language-julia hljs">prob = LSDProblem(grid, physics, opt)
sol = solve(prob)</code></pre><p>While <code>prob</code> can also be created without passing the solver options <code>opt</code> to the constructor, both the numerical grid <code>grid</code> and the physical setup <code>physics</code> have to be known. The implemented numerical grids are:</p><ul><li><a href="../spherical_grids.html#ExosphereSimulations.StructuredFullSGrid"><code>StructuredFullSGrid</code></a>,</li><li><a href="../spherical_grids.html#ExosphereSimulations.StructuredHalfSGrid"><code>StructuredHalfSGrid</code></a>,</li><li><a href="../spherical_grids.html#ExosphereSimulations.FSpiralFullSGrid"><code>FSpiralFullSGrid</code></a>,</li><li><a href="../spherical_grids.html#ExosphereSimulations.FSpiralHalfSGrid"><code>FSpiralHalfSGrid</code></a>,</li><li><a href="../spherical_grids.html#ExosphereSimulations.HEALPixFullSGrid"><code>HEALPixFullSGrid</code></a>.</li></ul><p>The physical parameters use a specific constructor called <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.LSDPhysics"><code>LSDPhysics</code></a>, which holds the necessary physical description of the problem based on input parameters. A more detailed list can be found on the <a href="input.html#lunar_exosphere_simulation_input"><strong>input page</strong></a>, which lists input parameters for various different species alongside a description and references. The general construction of the physics object is:</p><pre><code class="language-julia hljs">physics = LSDPhysics(amu, source_global, source_sunside, photorate, adheat, recycling, vdist)</code></pre><div class="admonition is-info"><header class="admonition-header">Velocity Distribution</header><div class="admonition-body"><p>In the current version, the variable <code>vdist</code> has to be of type <code>Symbol</code> referring to one of the implemented velocity distributions. The allowed options are:</p><ul><li><code>:Maxwell</code></li><li><code>:MaxwellBoltzmannFlux</code></li></ul></div></div><p>Finally, the solver options can be set manually, if the user should want to make changes to the default values. The constructor in question is <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.LSDOptions"><code>LSDOptions</code></a> and can be created empty</p><pre><code class="language-julia hljs">opt = LSDOptions()</code></pre><p>to access all the default parameters, or using a keyword-value pair like</p><pre><code class="language-julia hljs">opt = LSDOptions(; N = 2_500)</code></pre><p>which is adjusting the number of Monte-Carlo steps <code>N</code>. The available keywords can be found in the <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.LSDOptions"><code>LSDOptions</code></a> docstring.</p><p>Finally, now that the problem object <code>prob</code> has been created, we can pass it to the solver by</p><pre><code class="language-julia hljs">sol = solve(prob)</code></pre><p>which creates a solution object of type <a href="main.html#ExosphereSimulations.LunarSurfaceDensity.LSDSolution"><code>LSDSolution</code></a>, containing both the original problem <code>prob</code>, as well as the results of the simulation. Most importantly, it contains the predictions for the surface number densities <span>$n_0$</span> in cm<span>$^{-3}$</span> as <code>sol.n0</code>.</p><hr/><h3 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity" href="#ExosphereSimulations.LunarSurfaceDensity"><code>ExosphereSimulations.LunarSurfaceDensity</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Julia Package for simulating the surface number densities of the lunar surface-bounded exosphere.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.LSDOptions" href="#ExosphereSimulations.LunarSurfaceDensity.LSDOptions"><code>ExosphereSimulations.LunarSurfaceDensity.LSDOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LSDOptions(;
    N           ::  Int64     = 1000,
    vdist_N     ::  Int64     = 100_000,
    vdist_atol  ::  Float64   = 1e-1,
    photo_thr   ::  Float64   = 1e-3,
    dt          ::  Float64   = MOON_DAY / 360,
    ctrap_thr   ::  Float64   = 10.0,
    h0          ::  Float64   = 1.0,
    h0_N        ::  Int64     = 10,
)</code></pre><p>Custom container for all required solver options for the lunar surface density study. The description of the solver options is shown below:</p><table><tr><th style="text-align: left"><strong>Option</strong></th><th style="text-align: left"><strong>Description</strong></th><th style="text-align: left"><strong>Effect</strong></th></tr><tr><td style="text-align: left"><code>N</code></td><td style="text-align: left">Number of Monte-Carlo steps</td><td style="text-align: left">Simulation time, result accuracy</td></tr><tr><td style="text-align: left"><code>vdist_N</code></td><td style="text-align: left">Number of sample points for MBF velocity distribution</td><td style="text-align: left">MBF velocity, MBF calc. time</td></tr><tr><td style="text-align: left"><code>vdist_atol</code></td><td style="text-align: left">Absoltue tolerance of the MBF velocity calculation</td><td style="text-align: left">MBF calc. accuracy &amp; time</td></tr><tr><td style="text-align: left"><code>photo_thr</code></td><td style="text-align: left">Threshold of photo-processes</td><td style="text-align: left">Simulation time, result accuracy</td></tr><tr><td style="text-align: left"><code>dt</code></td><td style="text-align: left">Time step for surface interaction calculations</td><td style="text-align: left">Simulation time, ad-/desorption accuracy</td></tr><tr><td style="text-align: left"><code>ctrap_thr</code></td><td style="text-align: left">Cold-trap treshold</td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>h0</code></td><td style="text-align: left">Surface height</td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>h0_N</code></td><td style="text-align: left">Number of surface height intervalls</td><td style="text-align: left">Simulation time, result accuracy</td></tr></table><p><strong>Notes</strong></p><ul><li><code>vdist_N</code> &amp; <code>vdist_atol</code> are only relevant if the used velocity distribution is a Maxwell-Boltzmann Flux distribution</li><li><code>vdist_N</code> increases the maximum possible velocity</li><li><code>h0_N</code> gets more relevant for heavier particles and bigger <code>h0</code> values</li></ul></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.LSDPhysics" href="#ExosphereSimulations.LunarSurfaceDensity.LSDPhysics"><code>ExosphereSimulations.LunarSurfaceDensity.LSDPhysics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LSDPhysics(
    amu             ::  Float64, 
    source_global   ::  Float64, 
    source_sunside  ::  Float64, 
    photorate       ::  Float64, 
    adheat          ::  Float64
    recycling       ::  Float64, 
    vdist           ::  Symbol)</code></pre><p>Custom container for all required physical input parameters for the lunar surface density study.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.LSDProblem" href="#ExosphereSimulations.LunarSurfaceDensity.LSDProblem"><code>ExosphereSimulations.LunarSurfaceDensity.LSDProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LSDProblem{T&lt;:SGrid2D}(
    grid    ::  T,
    physics ::  LSDPhysics,
    opt     ::  LSDOptions,
    phi     ::  Vector{Float64},
    T       ::  Vector{Float64},
    tres    ::  Vector{Float64},
    vdist   ::  VelocityDistribution,
)
LSDProblem(grid::SGrid2D, physics::LSDPhysics, opt::LSDOptions)
LSDProblem(grid::SGrid2D, physics::LSDPhysics)</code></pre><p>Custom container of all necessary information to describe the lunar surface density simulation problem. It is not recommended to directly construct a <code>LSDProblem</code>, but  to use one of the additionally defined outer constructors.</p><p><code>LSDProblem</code> can be constructed without passing a <code>opt</code> to the constructor, at which the constructor will use the default <code>LSDOptions</code> values.</p><table><tr><th style="text-align: left">Field</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><code>grid</code></td><td style="text-align: left">Contains geometry and coordinates of the numerical grid</td></tr><tr><td style="text-align: left"><code>physics</code></td><td style="text-align: left">Contains physical input parameters for the simulation</td></tr><tr><td style="text-align: left"><code>opt</code></td><td style="text-align: left">Contains solver options</td></tr><tr><td style="text-align: left"><code>phi</code></td><td style="text-align: left">Solar incidence angles on the computational grid</td></tr><tr><td style="text-align: left"><code>T</code></td><td style="text-align: left">Surface temperatures on the computational grid</td></tr><tr><td style="text-align: left"><code>tres</code></td><td style="text-align: left">Residence time of the particle inside of the lunar regolith</td></tr><tr><td style="text-align: left"><code>vdist</code></td><td style="text-align: left">ExosphereSimulations velocity distribution struct</td></tr></table></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.LSDSolution" href="#ExosphereSimulations.LunarSurfaceDensity.LSDSolution"><code>ExosphereSimulations.LunarSurfaceDensity.LSDSolution</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LSDSolution(prob::LSDProblem, n0::Vector{FLoat64}, los::Vector{Float64})</code></pre><p>Custom solution struct for the solution of the lunar surface density simulation. It holds the initial problem definition <code>prob</code>, as well as the resulting surface density <code>n0</code> over the defined numerical grid in [cm-3] and the fractions of lost particles <code>lost</code> in [s-1].</p><p><strong>Description of <code>lost</code> vector</strong></p><table><tr><th style="text-align: left"></th><th style="text-align: left"><strong>Description</strong></th></tr><tr><td style="text-align: left"><code>lost[1]</code></td><td style="text-align: left">Fraction of particles lost through thermal escape</td></tr><tr><td style="text-align: left"><code>lost[2]</code></td><td style="text-align: left">Fraction of particles lost through ionization processes</td></tr><tr><td style="text-align: left"><code>lost[3]</code></td><td style="text-align: left">Fraction of particles lost in cold-traps</td></tr></table><p>The surface density can be directly accessed by indexing the solution object with normal brackets:</p><pre><code class="language-julia hljs">julia&gt; sol = solve(prob);

julia&gt; sol(12)
40231.123415</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.savesol" href="#ExosphereSimulations.LunarSurfaceDensity.savesol"><code>ExosphereSimulations.LunarSurfaceDensity.savesol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">savesol(name::String, sol::LSDSolution)</code></pre><p>Saves the solutions <code>sol</code> longitudes, latitudes, and surface number densities in a <code>.csv</code> file specified in <code>name</code>. The coordinates are taken directly from the underlying numerical grid.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.gridsavesol" href="#ExosphereSimulations.LunarSurfaceDensity.gridsavesol"><code>ExosphereSimulations.LunarSurfaceDensity.gridsavesol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gridsavesol(name::String, sol::LSDSolution, glngs::Vector{T}, glats::Vector{S}) where {T &lt;: Real, S &lt;: Real})</code></pre><p>Saves the solutions <code>sol</code> longitudes, latitudes, and surface number densities in a <code>.csv</code> file specified in <code>name</code>. The coordinates are a grid created using the inputs <code>glngs</code> and  <code>glats</code>, which are the longitudinal and latitudinal sample points. </p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.solve" href="#ExosphereSimulations.LunarSurfaceDensity.solve"><code>ExosphereSimulations.LunarSurfaceDensity.solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve(prob::LSDProblem; logstep=10)</code></pre><p>Main simulation function of the lunar surface density simulation module. Requires prior definition of the module specific problem struct <code>prob</code> of type <code>LSDProblem</code>. The input <code>logstep</code> sets the intervall for logged information to be printed in the terminal during the simulation.</p><p>The function features a parallelized simulation call that splits the Monte-Carlo steps onto the available workers.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity.path" href="#ExosphereSimulations.LunarSurfaceDensity.path"><code>ExosphereSimulations.LunarSurfaceDensity.path</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">path(prob::LSDProblem, idx::Int64, w::Real)</code></pre><p>Calculate the path of a particle, initially launched from the grid element with index <code>idx</code> with a weight of <code>w</code>. Loops until the particle is lost. Returns particle density along the path and the lost fraction vector.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity._height_time" href="#ExosphereSimulations.LunarSurfaceDensity._height_time"><code>ExosphereSimulations.LunarSurfaceDensity._height_time</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_height_time(v::Real, h=1e0; N=1)</code></pre><p>Internal function to compute the time a particle with vertical velocity <code>v</code> in  meters per second requires to reach <code>h</code> meter above ground. The additional variable <code>N</code> gives the number of parts the height is split into while calculating the  total travel time.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity._particle_flight!" href="#ExosphereSimulations.LunarSurfaceDensity._particle_flight!"><code>ExosphereSimulations.LunarSurfaceDensity._particle_flight!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_particle_flight!(prob::LSDProblem, N0::AbstractVector, idx::Int64, coords::Tuple, w::Real, w0::Real)</code></pre><p>Internal function to handle the ballistic flight of the particle launched at coordinates given in <code>coords</code>, at the grid element of index <code>idx</code>, with a current weight of <code>w</code> and a initial weight of <code>w0</code>. Fills the entries of the resulting particle density vector <code>N0</code>  depending on the launch and landing position and velocity. Returns the landing grid element index, the exact landing coordinates, and the new, updated weight.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ExosphereSimulations.LunarSurfaceDensity._surface_interaction" href="#ExosphereSimulations.LunarSurfaceDensity._surface_interaction"><code>ExosphereSimulations.LunarSurfaceDensity._surface_interaction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_surface_interaction(prob::LSDProblem, idx::Int64, coords::Tuple)</code></pre><p>Internal function to handle the surface interaction. Dynamically adjusts the longitude with respect to the time the particle has spend inside of the surface. Returns the index of the element from where the particle is released, along side its exact coordinates.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../velocity_distribution.html">« <strong>V</strong>elocity Distributions</a><a class="docs-footer-nextpage" href="input.html">Input »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Wednesday 27 April 2022 11:13">Wednesday 27 April 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
